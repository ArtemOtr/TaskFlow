# TaskFlow

## Что это?

Система управления задачами, способная выполнять DAG (направленный ациклический граф) задач с зависимостями асинхронно.

## Возможности системы

1. Определение задач и зависимостей 
2. Асинхронное выполнение независимых задач
3. Управление состоянием и retry логика
4. Web UI для мониторинга

## Чеклист того, что надо сделать

Обязательно (для сдачи)
1. Retry логика - добавить повторы при ошибках
2. Обработка ошибок - try/except вокруг операций
3. SQLite персистентность - сохранять состояние в БД
4. Web UI - простой HTTP сервер с статусом задач
5. asyncio.Queue - использовать для управления задачами
6. Контекстные менеджеры - для изоляции выполнени
7. Возможность отправки POST запросов на сервер с возвращением ссылки или данных
	- /api/web - возвращает ссылку на web_ui
	- /api/cli - возвращает ZIP архив с данными
8. Запуск по cron через Telegram

Уже есть/почти готово
Базовый оркестратор - ядро работает
DAG выполнение - зависимости обрабатываются
Асинхронность - asyncio используется
Параллельное выполнение - независимые задачи запускаются вместе
Нужно сделать так, чтобы юзеры могли менять только filename, созранять конфиги в отдельной папке по dag_id
Сделать так, чтобы данные графа созранялись в dag/dag_{id}, после конца работы графа архивировались
## Доп. возможности

Делать граф по XML из 4diac


## Как работает конфиг

Пример конфига представлен в файле dag_config_example.json, который представляет простой пайплайн (Получение json по API -> Конвертация json в строку -> Отправка строки в Telegram ботом по username)

### Поля конфига

```
{
  "dag_name": "Уникальный идентификатор DAG (строка). Задается пользователем для идентификации рабочего процесса",
  "max_retries": "Количество перезапусков при пажении операции",
  "retry_delay": "Задержка при перезапуске в сек.",
  "tasks": [
    {
      "id": "Уникальный идентификатор задачи (строка). Задается пользователем для ссылок между задачами",
      "operation": "Название операции из библиотеки компонентов (строка). Определяет тип выполняемой задачи",
      "independent_params": {
        "description": "Параметры, не зависящие от других задач (объект). Содержат статические значения и настройки",
      },
      "dependent_params": {
        "description": "Параметры, зависящие от результатов других задач (объект). Используют выходные данные предыдущих шагов. Имекют приоритет выше чем independent_params.",
      },
      "dependencies": [
        "description": "Спиок id задач-предшественников (массив строк). Определяет порядок выполнения workflow"
      ]
    }
  ]
}
```
## TODO LIST
 - Логгирование нормальное сделать
 - Допилить чат бота, реализовать управление нескольками dag через телеграмм, добавить функциональности
 - Че то еще

# Установка и запуск

### 1. Клонирование репозитория
```bash
git clone https://github.com/yourusername/TaskFlow.git
cd TaskFlow
```
### 2. Установка зависимостей
```bash
pip install -r requirements.txt
```
### 3. Запуск системы
```bash
python main.py

# Сервис будет доступен по адресу
# http://0.0.0.0:5000
```

